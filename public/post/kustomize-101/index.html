<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="é’å¹´å¤æ—¥IT">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="https://qnxr.xyz/img/home-bg-jeep.jpg">
    <meta property="twitter:image" content="https://qnxr.xyz/img/home-bg-jeep.jpg" />
    

    
    <meta name="title" content="ä½¿ç”¨ Kustomize é…ç½® Kubernetes åº”ç”¨" />
    <meta property="og:title" content="ä½¿ç”¨ Kustomize é…ç½® Kubernetes åº”ç”¨" />
    <meta property="twitter:title" content="ä½¿ç”¨ Kustomize é…ç½® Kubernetes åº”ç”¨" />
    

    
    <meta name="description" content="é’å¹´å¤æ—¥ï¼Œç¨‹åºå‘˜, å¼€æºçˆ±å¥½è€…ï¼Œç”Ÿæ´»æ¢é™©å®¶ | è¿™é‡Œæ˜¯ é’å¹´å¤æ—¥ çš„åšå®¢ï¼Œä¸ä½ ä¸€èµ·å‘ç°æ›´å¤§çš„ä¸–ç•Œã€‚">
    <meta property="og:description" content="é’å¹´å¤æ—¥ï¼Œç¨‹åºå‘˜, å¼€æºçˆ±å¥½è€…ï¼Œç”Ÿæ´»æ¢é™©å®¶ | è¿™é‡Œæ˜¯ é’å¹´å¤æ—¥ çš„åšå®¢ï¼Œä¸ä½ ä¸€èµ·å‘ç°æ›´å¤§çš„ä¸–ç•Œã€‚" />
    <meta property="twitter:description" content="é’å¹´å¤æ—¥ï¼Œç¨‹åºå‘˜, å¼€æºçˆ±å¥½è€…ï¼Œç”Ÿæ´»æ¢é™©å®¶ | è¿™é‡Œæ˜¯ é’å¹´å¤æ—¥ çš„åšå®¢ï¼Œä¸ä½ ä¸€èµ·å‘ç°æ›´å¤§çš„ä¸–ç•Œã€‚" />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="é’å¹´å¤æ—¥, åšå®¢, ä¸ªäººç½‘ç«™, äº’è”ç½‘, Web, äº‘åŸç”Ÿ, PaaS, Istio, Kubernetes, å¾®æœåŠ¡, Microservice">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>ä½¿ç”¨ Kustomize é…ç½® Kubernetes åº”ç”¨-é’å¹´å¤æ—¥IT</title>

    <link rel="canonical" href="/post/kustomize-101/">

    <link rel="stylesheet" href="/css/iDisqus.min.css"/>

    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">

    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" rel="stylesheet" type="text/css">

    
    

    
    
    <script src="/js/jquery.min.js"></script>

    
    <script src="/js/bootstrap.min.js"></script>

    
    <script src="/js/hux-blog.min.js"></script>

    
    

</head>



<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">é’å¹´å¤æ—¥IT</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                        
                        <li>
                            <a href="/categories/life">life</a>
                        </li>
                        
                        <li>
                            <a href="/categories/note">note</a>
                        </li>
                        
                        <li>
                            <a href="/categories/tech">tech</a>
                        </li>
                        
                        <li>
                            <a href="/categories/tips">tips</a>
                        </li>
                        
                    
                    
		    
                        <li><a href="/top/books/">BOOKS</a></li>
                    
                        <li><a href="/top/about/">ABOUT</a></li>
                    

                    
		    <li>
                        <a href="/search">SEARCH <img src="/img/search.png" height="15" style="cursor: pointer;" alt="Search"></a>
		    </li>
                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('/img/home-bg-jeep.jpg')
    }
</style>
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/kubernetes" title="kubernetes">
                            kubernetes
                        </a>
                        
                        <a class="tag" href="/tags/helm" title="helm">
                            helm
                        </a>
                        
                        <a class="tag" href="/tags/kustomize" title="kustomize">
                            kustomize
                        </a>
                        
                    </div>
                    <h1>ä½¿ç”¨ Kustomize é…ç½® Kubernetes åº”ç”¨</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        Posted by 
                        
                                é’å¹´å¤æ—¥IT
                         
                        on 
                        Friday, August 16, 2019
                        
                        
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                post-container">

                
                <header>
                    <h2>TOC</h2>
                </header>
                <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#å®‰è£…">å®‰è£…</a></li>
        <li><a href="#åŸºç¡€æ¨¡æ¿">åŸºç¡€æ¨¡æ¿</a></li>
        <li><a href="#å®šåˆ¶">å®šåˆ¶</a></li>
        <li><a href="#æ€»ç»“">æ€»ç»“</a></li>
        <li><a href="#å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</a></li>
      </ul>
    </li>
  </ul>
</nav>
                
                <p>å¦‚æœä½ ç»å¸¸ä½¿ç”¨ Kubernetesï¼Œé‚£ä¹ˆä½ è‚¯å®šå°±æœ‰å®šåˆ¶èµ„æºæ¸…å•æ–‡ä»¶çš„éœ€æ±‚ï¼Œä½†æ˜¯è²Œä¼¼ç°åœ¨å¤§å®¶éƒ½æ¯”è¾ƒå–œæ¬¢ä½¿ç”¨ Helmï¼ŒHelm å¾ˆå¥½ç”¨ï¼Œä½†ä¹Ÿæœ‰å¾ˆå¤šç¼ºç‚¹ï¼Œæ¯”å¦‚éœ€è¦ä¸€ä¸ª tiller æœåŠ¡ç«¯ï¼Œéœ€è¦è¶…é«˜çš„æƒé™ï¼Œæœ€é‡è¦çš„æ˜¯å¦‚æœä½ è¦æƒ³è‡ªå·±åšä¸€ä¸ª Helm Chart åŒ…çš„è¯ï¼Œåˆ™ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“çš„ï¼Œéœ€è¦ä½ äº†è§£ä¸€äº› go template çš„ç›¸å…³çŸ¥è¯†ï¼Œå®ƒæŠ›å¼ƒäº†æˆ‘ä»¬åœ¨ Docker å’Œ Kubernetes ä¸Šé¢å­¦åˆ°çš„ä¸€äº›é€»è¾‘ï¼Œä»Šå¤©æˆ‘ä»¬å°†ä¸ºå¤§å®¶ä»‹ç»å¦å¤–ä¸€ç§åä¸º<code>Kustomizeâ¤ï¸</code>çš„æ›¿ä»£å·¥å…·ã€‚</p>
<p>å®é™…ä¸Š Kustomize å¹¶ä¸æ˜¯ä¸€ä¸ªæ–°çš„å·¥å…·ï¼Œè€Œä¸”ç°åœ¨å·²ç»è¢«é›†æˆåœ¨äº† kubectl 1.14 ç‰ˆæœ¬çš„å­å‘½ä»¤ä¸­äº†ï¼Œæ˜¯ä¸æ˜¯éå¸¸æ–¹ä¾¿äº†ï¼Œå…å»äº†å®‰è£…ç¬¬ä¸‰æ–¹å·¥å…·çš„éº»çƒ¦ï¼Œå› ä¸º kubectl å·¥å…·åŸºæœ¬ä¸Šæ˜¯æˆ‘ä»¬å¤©å¤©éƒ½åœ¨ä½¿ç”¨çš„ï¼Œæ‰€ä»¥&hellip;&hellip;ä½ å¯ä»¥æŠŠ Helm å‘½ä»¤æ‰”æ‰äº†ğŸ˜‰ã€‚</p>
<p>Kustomize å’Œ Kubernetes ä¸€æ ·ï¼Œå®ƒå®Œå…¨å°±æ˜¯å£°æ˜å¼çš„ï¼Œä½ è¯´ä½ æƒ³è¦ä»€ä¹ˆï¼Œç³»ç»Ÿå°±æä¾›ç»™ä½ ä»€ä¹ˆï¼Œä¸éœ€è¦éµå¾ªå‘½ä»¤æ–¹å¼æ¥æè¿°ä½ å¸Œæœ›æ„å»ºçš„å¯¹è±¡ã€‚</p>
<p>å…¶æ¬¡ï¼Œå®ƒå’Œ Docker æ¯”è¾ƒç±»ä¼¼ï¼Œæœ‰å¾ˆå¤šå±‚ç»„æˆï¼Œæ¯ä¸ªå±‚éƒ½æ˜¯ä¿®æ”¹ä»¥å‰çš„å±‚ï¼Œæ­£å› ä¸ºæœ‰è¿™ä¸ªç†å¿µå­˜åœ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸æ–­åœ¨å…¶ä»–äººè‡³ä¸Šå†™ä¸œè¥¿ï¼Œè€Œä¸ä¼šå¢åŠ é…ç½®çš„å¤æ‚æ€§ï¼Œæ„å»ºçš„æœ€ç»ˆç»“æœç”±åŸºç¡€éƒ¨åˆ†å’Œä½ åœ¨ä¸Šé¢é…ç½®çš„å…¶ä»–å±‚ç»„æˆã€‚</p>
<p>
  <img src="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/kubernetes-kustomize.jpg" alt="kubernetes kustomize">

</p>
<p>æœ€åï¼Œå’Œ Git ä¸€æ ·ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè¿œç¨‹çš„åŸºç¡€é…ç½®ä½œä¸ºæœ€åŸå§‹çš„é…ç½®ï¼Œç„¶ååœ¨è¯¥åŸºç¡€ä¸Šæ·»åŠ ä¸€äº›è‡ªå®šä¹‰çš„é…ç½®ã€‚</p>
<h2 id="å®‰è£…">å®‰è£…</h2>
<p>å¯¹äº ğŸMac ç”¨æˆ·æ¥è¯´ï¼Œä½ å¯ä»¥ä½¿ç”¨ brew å·¥å…·æ¥ç›´æ¥å®‰è£…ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ brew install kustomize
</code></pre></div><p>å½“ç„¶å¦‚æœä½ ä½¿ç”¨çš„æ˜¯å…¶ä»–æ“ä½œç³»ç»Ÿï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥ä» <a href="https://github.com/Kubernetes-sigs/kustomize/blob/master/docs/INSTALL.md">Release é¡µé¢</a>ä¸Šé¢ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶ç„¶åæ·»åˆ° PATH è·¯å¾„ä¸‹é¢å³å¯ã€‚å½“ç„¶å¦‚æœä½ æ„¿æ„ä¹Ÿå¯ä»¥ä»æºç ä¸­ç›´æ¥æ„å»ºï¼Œä»£ç ä»“åº“ï¼š<a href="https://github.com/Kubernetes-sigs/kustomize">https://github.com/Kubernetes-sigs/kustomize</a>ã€‚</p>
<h2 id="åŸºç¡€æ¨¡æ¿">åŸºç¡€æ¨¡æ¿</h2>
<p>è¦ä½¿ç”¨ Kustomizeï¼Œä½ éœ€è¦æœ‰ä¸€ä¸ªåŸå§‹çš„ yaml æ–‡ä»¶æ¥æè¿°ä½ æƒ³è¦éƒ¨ç½²åˆ°é›†ç¾¤ä¸­çš„ä»»ä½•èµ„æºï¼Œæˆ‘ä»¬è¿™é‡Œå°†è¿™äº› base æ–‡ä»¶å­˜å‚¨åœ¨<code>./k8s/base/</code>æ–‡ä»¶å¤¹ä¸‹é¢ã€‚</p>
<p>è¿™äº›æ–‡ä»¶æˆ‘ä»¬<strong>æ°¸è¿œ</strong>ä¸ä¼šç›´æ¥è®¿é—®ï¼Œæˆ‘ä»¬å°†åœ¨å®ƒä»¬ä¸Šé¢æ·»åŠ ä¸€äº›è‡ªå®šä¹‰çš„é…ç½®æ¥åˆ›å»ºæ–°çš„èµ„æºå®šä¹‰ã€‚</p>
<blockquote>
<p>ä½ å¯ä»¥åœ¨ä»»ä½•æ—¶é—´ç‚¹ä½¿ç”¨<code>kubectl apply -f ./k8s/base/</code>å‘½ä»¤æ¥æ„å»ºåŸºç¡€æ¨¡æ¿ã€‚</p>
</blockquote>
<p>ä¸‹é¢ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Service å’Œ Deployment èµ„æºå¯¹è±¡ä¸ºä¾‹è¿›è¡Œè¯´æ˜ã€‚ä¸‹é¢å®šä¹‰ä¸¤ä¸ªèµ„æºæ¸…å•æ–‡ä»¶ï¼š
service.yaml å®šä¹‰å¦‚ä¸‹:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ff79c6">apiVersion</span>: v1
<span style="color:#ff79c6">kind</span>: Service
<span style="color:#ff79c6">metadata</span>:
  <span style="color:#ff79c6">name</span>: sl-demo-app
<span style="color:#ff79c6">spec</span>:
  <span style="color:#ff79c6">ports</span>:
    - <span style="color:#ff79c6">name</span>: http
      <span style="color:#ff79c6">port</span>: <span style="color:#bd93f9">8080</span>
  <span style="color:#ff79c6">selector</span>:
    <span style="color:#ff79c6">app</span>: sl-demo-app
</code></pre></div><p>deployment.yaml å®šä¹‰å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ff79c6">apiVersion</span>: apps/v1
<span style="color:#ff79c6">kind</span>: Deployment
<span style="color:#ff79c6">metadata</span>:
  <span style="color:#ff79c6">name</span>: sl-demo-app
<span style="color:#ff79c6">spec</span>:
  <span style="color:#ff79c6">selector</span>:
    <span style="color:#ff79c6">matchLabels</span>:
      <span style="color:#ff79c6">app</span>: sl-demo-app
  <span style="color:#ff79c6">template</span>:
    <span style="color:#ff79c6">metadata</span>:
      <span style="color:#ff79c6">labels</span>:
        <span style="color:#ff79c6">app</span>: sl-demo-app
    <span style="color:#ff79c6">spec</span>:
      <span style="color:#ff79c6">containers</span>:
      - <span style="color:#ff79c6">name</span>: app
        <span style="color:#ff79c6">image</span>: foo/bar:latest
        <span style="color:#ff79c6">ports</span>:
        - <span style="color:#ff79c6">name</span>: http
          <span style="color:#ff79c6">containerPort</span>: <span style="color:#bd93f9">8080</span>
          <span style="color:#ff79c6">protocol</span>: TCP
</code></pre></div><p>ç„¶ååœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹é¢æ·»åŠ ä¸€ä¸ªåä¸º<code>kustomization.yaml</code>çš„æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ff79c6">apiVersion</span>: kustomize.config.k8s.io/v1beta1
<span style="color:#ff79c6">kind</span>: Kustomization

<span style="color:#ff79c6">resources</span>:
  - service.yaml
  - deployment.yaml
</code></pre></div><p>è¿™ä¸ªæ–‡ä»¶å°†æ˜¯ä½ çš„åŸºç¡€é…ç½®æ–‡ä»¶ï¼Œå®ƒæè¿°äº†ä½ ä½¿ç”¨çš„èµ„æºæ–‡ä»¶ã€‚</p>
<blockquote>
<p>å½“ä½ è¿è¡Œ<code>kubectl apply -f ./k8s/base/</code>å‘½ä»¤æ—¶ï¼Œè¯¥<code>kustomization.yaml</code>æ–‡ä»¶å¯èƒ½ä¼šå‡ºç°ä¸€äº›é”™è¯¯ï¼Œä½ å¯ä»¥æ·»åŠ å‚æ•°<code>--validate=false</code>è¿›è¡Œæ ¡éªŒï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸é’ˆå¯¹æ•´ä¸ªæ–‡ä»¶å¤¹è¿è¡Œè¯¥å‘½ä»¤ã€‚</p>
</blockquote>
<p>è¦å°†åŸºç¡€æ¨¡æ¿ä¸­çš„èµ„æºå®‰è£…åˆ°ä½ çš„é›†ç¾¤ä¸­ï¼Œåªéœ€è¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl apply -k k8s/base
service/sl-demo-app created
deployment.apps/sl-demo-app created
</code></pre></div><p>ä¸ºäº†äº†è§£å°†å®‰è£…ä»€ä¹ˆèµ„æºåˆ°é›†ç¾¤ä¸­ï¼Œæˆ‘ä»¬åœ¨æœ¬æ–‡ä¸­ä¸»è¦ä½¿ç”¨<code>kustomize build</code>å‘½ä»¤æ¥ä»£æ›¿<code>kubectl apply -k</code>å‘½ä»¤ã€‚å½“ç„¶ä½¿ç”¨<code>kubectl kustomize</code>å‘½ä»¤ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºæˆ‘ä»¬è¯´äº† kubectl 1.14 ç‰ˆæœ¬ä»¥åå°±å·²ç»é›†æˆäº† kustomizeã€‚</p>
<!-- raw HTML omitted -->
<p>ä½¿ç”¨<code>kustomize build</code>å‘½ä»¤è¿è¡Œåçš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸¤ä¸ªæ–‡ä»¶è¿æ¥åœ¨ä¸€èµ·ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomize build k8s/base
apiVersion: v1
kind: Service
metadata:
  name: sl-demo-app
spec:
  ports:
  - name: http
    port: <span style="color:#bd93f9">8080</span>
  selector:
    app: sl-demo-app
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  selector:
    matchLabels:
      app: sl-demo-app
  template:
    metadata:
      labels:
        app: sl-demo-app
    spec:
      containers:
      - image: foo/bar:latest
        name: app
        ports:
        - containerPort: <span style="color:#bd93f9">8080</span>
          name: http
          protocol: TCP
</code></pre></div><h2 id="å®šåˆ¶">å®šåˆ¶</h2>
<p>ç°åœ¨æˆ‘ä»¬æƒ³è¦é’ˆå¯¹ä¸€äº›ç‰¹å®šåœºæ™¯è¿›è¡Œå®šåˆ¶ï¼Œæ¯”å¦‚ï¼Œé’ˆå¯¹ç”Ÿäº§ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒéœ€è¦ç”±ä¸åŒçš„é…ç½®ã€‚æˆ‘ä»¬è¿™é‡Œå¹¶ä¸ä¼šæ¶µç›– Kustomize çš„æ•´ä¸ªåŠŸèƒ½é›†ï¼Œè€Œæ˜¯ä½œä¸ºä¸€ä¸ªæ ‡å‡†ç¤ºä¾‹ï¼Œå‘ä½ å±•ç¤ºè¿™ä¸ªå·¥å…·èƒŒåçš„å“²å­¦ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹<code>k8s/overlays/prod</code>ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º<code>kustomzization.yaml</code>çš„æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ff79c6">apiVersion</span>: kustomize.config.k8s.io/v1beta1
<span style="color:#ff79c6">kind</span>: Kustomization

<span style="color:#ff79c6">bases</span>:
- ../../base
</code></pre></div><p>å½“å‰æ–‡ä»¶å¤¹ä¸‹é¢çš„ç›®å½•ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ tree
.
â””â”€â”€ k8s
    â”œâ”€â”€ base
    â”‚Â Â  â”œâ”€â”€ deployment.yaml
    â”‚Â Â  â”œâ”€â”€ kustomization.yaml
    â”‚Â Â  â””â”€â”€ service.yaml
    â””â”€â”€ overlays
        â””â”€â”€ prod
            â””â”€â”€ kustomization.yaml
</code></pre></div><p>å¦‚æœç°åœ¨æˆ‘ä»¬æ„å»ºè¿™ä¸ªæ–‡ä»¶ï¼Œå°†ä¼šçœ‹åˆ°å’Œä¹‹å‰æ„å»º base ç›®å½•ä¸€æ ·çš„ç»“æœï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomzie build k8s/overlays/prod
apiVersion: v1
kind: Service
metadata:
  name: sl-demo-app
spec:
  ports:
  - name: http
    port: <span style="color:#bd93f9">8080</span>
  selector:
    app: sl-demo-app
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  selector:
    matchLabels:
      app: sl-demo-app
  template:
    metadata:
      labels:
        app: sl-demo-app
    spec:
      containers:
      - image: foo/bar:latest
        name: app
        ports:
        - containerPort: <span style="color:#bd93f9">8080</span>
          name: http
          protocol: TCP
</code></pre></div><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥ä¸ºæˆ‘ä»¬çš„<code>prod</code>ç¯å¢ƒè¿›è¡Œä¸€äº›å®šåˆ¶ã€‚</p>
<h3 id="å®šä¹‰ç¯å¢ƒå˜é‡">å®šä¹‰ç¯å¢ƒå˜é‡</h3>
<p>åœ¨ base åŸºç¡€æ¨¡æ¿ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰ä»»ä½•ç¯å¢ƒå˜é‡ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€äº›ç¯å¢ƒå˜é‡åœ¨ä¹‹å‰çš„åŸºç¡€æ¨¡æ¿ä¸­ã€‚å®é™…ä¸Šå¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æˆ‘ä»¬çš„åŸºç¡€æ¨¡æ¿ä¸Šåˆ›å»ºä¸€å—æˆ‘ä»¬æƒ³è¦æ¨¡æ¿åŒ–çš„ä»£ç å—ï¼Œç„¶åå°†å…¶å¼•ç”¨åˆ°<code>kustomization.yaml</code>æ–‡ä»¶ä¸­å³å¯ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬è¿™é‡Œå®šä¹‰ä¸€ä¸ªåŒ…å«ç¯å¢ƒå˜é‡çš„é…ç½®æ–‡ä»¶ï¼š(custom-env.yaml)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ff79c6">apiVersion</span>: apps/v1
<span style="color:#ff79c6">kind</span>: Deployment
<span style="color:#ff79c6">metadata</span>:
  <span style="color:#ff79c6">name</span>: sl-demo-app
<span style="color:#ff79c6">spec</span>:
  <span style="color:#ff79c6">template</span>:
    <span style="color:#ff79c6">spec</span>:
      <span style="color:#ff79c6">containers</span>:
        - <span style="color:#ff79c6">name</span>: app <span style="color:#6272a4"># (1)</span>
          <span style="color:#ff79c6">env</span>:
            - <span style="color:#ff79c6">name</span>: CUSTOM_ENV_VARIABLE
              <span style="color:#ff79c6">value</span>: Value defined by Kustomize â¤ï¸
</code></pre></div><blockquote>
<p>æ³¨æ„ (1) è¿™é‡Œå®šä¹‰çš„ name æ˜¯éå¸¸é‡è¦çš„ï¼Œkustomize ä¼šé€šè¿‡è¯¥å€¼æ‰¾åˆ°éœ€è¦ä¿®æ”¹çš„å®¹å™¨ã€‚</p>
</blockquote>
<p>è¿™ä¸ª yaml æ–‡ä»¶æœ¬èº«æ˜¯æ— æ•ˆçš„ï¼Œå®ƒåªæè¿°äº†æˆ‘ä»¬å¸Œæœ›åœ¨ä¸Šé¢çš„åŸºç¡€æ¨¡æ¿ä¸Šæ·»åŠ çš„å†…å®¹ã€‚æˆ‘ä»¬åªéœ€è¦å°†è¿™ä¸ªæ–‡ä»¶æ·»åŠ åˆ°<code>k8s/overlays/prod/kustomization.yaml</code>æ–‡ä»¶ä¸­å³å¯ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ff79c6">apiVersion</span>: kustomize.config.k8s.io/v1beta1
<span style="color:#ff79c6">kind</span>: Kustomization

<span style="color:#ff79c6">bases</span>:
- ../../base

<span style="color:#ff79c6">patchesStrategicMerge</span>:
- custom-env.yaml

</code></pre></div><p>ç°åœ¨å¦‚æœæˆ‘ä»¬æ¥æ„å»ºä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„è¾“å‡ºç»“æœï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomize build k8s/overlays/prod
apiVersion: v1
kind: Service
metadata:
  name: sl-demo-app
spec:
  ports:
  - name: http
    port: <span style="color:#bd93f9">8080</span>
  selector:
    app: sl-demo-app
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  selector:
    matchLabels:
      app: sl-demo-app
  template:
    metadata:
      labels:
        app: sl-demo-app
    spec:
      containers:
      - env:
        - name: CUSTOM_ENV_VARIABLE
          value: Value defined by Kustomize â¤ï¸
        image: foo/bar:latest
        name: app
        ports:
        - containerPort: <span style="color:#bd93f9">8080</span>
          name: http
          protocol: TCP
</code></pre></div><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„ env å—å·²ç»è¢«åˆå¹¶åˆ°äº†æˆ‘ä»¬çš„åŸºç¡€æ¨¡æ¿ä¸Šäº†ï¼Œè‡ªå®šä¹‰çš„ env å˜é‡å‡ºç°åœ¨äº† deployment.yaml æ–‡ä»¶ä¸­ã€‚</p>
<h3 id="ä¿®æ”¹å‰¯æœ¬æ•°é‡">ä¿®æ”¹å‰¯æœ¬æ•°é‡</h3>
<p>å’Œä¸Šé¢çš„ä¾‹å­ä¸€æ ·ï¼Œæˆ‘ä»¬æ¥æ‰©å±•æˆ‘ä»¬çš„åŸºç¡€æ¨¡æ¿æ¥å®šä¹‰ä¸€äº›è¿˜æ²¡æœ‰å®šä¹‰çš„å˜é‡ã€‚</p>
<blockquote>
<p>ä½ ä¹Ÿå¯ä»¥è¦†ç›–ä¸€äº›åœ¨ base æ–‡ä»¶ä¸­å·²æœ‰çš„å˜é‡ã€‚</p>
</blockquote>
<p>è¿™é‡Œæˆ‘ä»¬æ¥æ·»åŠ ä¸€äº›å…³äºå‰¯æœ¬çš„ä¿¡æ¯ï¼Œå’Œå‰é¢ä¸€æ ·ï¼Œåªéœ€è¦åœ¨ä¸€ä¸ª YAML æ–‡ä»¶ä¸­å®šä¹‰å‰¯æœ¬æ‰€éœ€çš„é¢å¤–ä¿¡æ¯å—ï¼Œæ–°å»ºä¸€ä¸ªåä¸º<code>replica-and-rollout-strategy.yaml</code> çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ff79c6">apiVersion</span>: apps/v1
<span style="color:#ff79c6">kind</span>: Deployment
<span style="color:#ff79c6">metadata</span>:
  <span style="color:#ff79c6">name</span>: sl-demo-app
<span style="color:#ff79c6">spec</span>:
  <span style="color:#ff79c6">replicas</span>: <span style="color:#bd93f9">10</span>
  <span style="color:#ff79c6">strategy</span>:
    <span style="color:#ff79c6">rollingUpdate</span>:
      <span style="color:#ff79c6">maxSurge</span>: <span style="color:#bd93f9">1</span>
      <span style="color:#ff79c6">maxUnavailable</span>: <span style="color:#bd93f9">1</span>
    <span style="color:#ff79c6">type</span>: RollingUpdate
</code></pre></div><p>å’Œå‰é¢ä¸€æ ·ï¼Œåœ¨<code>kustomization.yaml</code>æ–‡ä»¶ä¸­çš„<code>patchesStrategicMerge</code>ä¸‹é¢æ·»åŠ è¿™é‡Œå®šåˆ¶çš„æ•°æ®ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ff79c6">apiVersion</span>: kustomize.config.k8s.io/v1beta1
<span style="color:#ff79c6">kind</span>: Kustomization

<span style="color:#ff79c6">bases</span>:
- ../../base

<span style="color:#ff79c6">patchesStrategicMerge</span>:
- custom-env.yaml
- replica-and-rollout-strategy.yaml
</code></pre></div><p>åŒæ ·ï¼Œè¿™ä¸ªæ—¶å€™å†ä½¿ç”¨<code>kustomize build</code>å‘½ä»¤æ„å»ºï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomize build k8s/overlays/prod
apiVersion: v1
kind: Service
metadata:
  name: sl-demo-app
spec:
  ports:
  - name: http
    port: <span style="color:#bd93f9">8080</span>
  selector:
    app: sl-demo-app
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  replicas: <span style="color:#bd93f9">10</span>
  selector:
    matchLabels:
      app: sl-demo-app
  strategy:
    rollingUpdate:
      maxSurge: <span style="color:#bd93f9">1</span>
      maxUnavailable: <span style="color:#bd93f9">1</span>
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: sl-demo-app
    spec:
      containers:
      - env:
        - name: CUSTOM_ENV_VARIABLE
          value: Value defined by Kustomize â¤ï¸
        image: foo/bar:latest
        name: app
        ports:
        - containerPort: <span style="color:#bd93f9">8080</span>
          name: http
          protocol: TCP
</code></pre></div><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‰¯æœ¬æ•°é‡å’Œæ»šåŠ¨æ›´æ–°çš„ç­–ç•¥éƒ½æ·»åŠ åˆ°äº†åŸºç¡€æ¨¡æ¿ä¹‹ä¸Šäº†ã€‚</p>
<h3 id="é€šè¿‡å‘½ä»¤è¡Œå®šä¹‰-secret">é€šè¿‡å‘½ä»¤è¡Œå®šä¹‰ secret</h3>
<p>æˆ‘ä»¬å¸¸å¸¸ä¼šé€šè¿‡å‘½ä»¤è¡Œæ¥æ·»åŠ ä¸€ä¸ª secret å¯¹è±¡ï¼Œ<code>kustomize</code>æœ‰ä¸€ä¸ª<code>edit</code>çš„å­å‘½ä»¤å¯ä»¥ç”¨æ¥ç¼–è¾‘<code>kustomization.yaml</code>æ–‡ä»¶ç„¶ååˆ›å»ºä¸€ä¸ª secret å¯¹è±¡ï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™é‡Œæ·»åŠ ä¸€ä¸ªå¦‚ä¸‹æ‰€ç¤ºçš„ secret å¯¹è±¡ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ <span style="color:#8be9fd;font-style:italic">cd</span> k8s/overlays/prod
$ kustomize edit add secret sl-demo-app --from-literal<span style="color:#ff79c6">=</span>db-password<span style="color:#ff79c6">=</span><span style="color:#bd93f9">12345</span>
</code></pre></div><p>ä¸Šé¢çš„å‘½ä»¤ä¼šä¿®æ”¹<code>kustomization.yaml</code>æ–‡ä»¶æ·»åŠ ä¸€ä¸ª<code>SecretGenerator</code>å­—æ®µåœ¨é‡Œé¢ã€‚</p>
<blockquote>
<p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡æ–‡ä»¶ï¼ˆæ¯”å¦‚<code>--from-file=file/path</code>æˆ–è€…<code>--from-evn-file=env/path.env</code>ï¼‰æ¥åˆ›å»º secret å¯¹è±¡ã€‚</p>
</blockquote>
<p>é€šè¿‡ä¸Šé¢å‘½ä»¤åˆ›å»ºå®Œ secret å¯¹è±¡åï¼Œ<code>kustomization.yaml</code>æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ff79c6">apiVersion</span>: kustomize.config.k8s.io/v1beta1
<span style="color:#ff79c6">kind</span>: Kustomization

<span style="color:#ff79c6">bases</span>:
- ../../base

<span style="color:#ff79c6">patchesStrategicMerge</span>:
- custom-env.yaml
- replica-and-rollout-strategy.yaml
<span style="color:#ff79c6">secretGenerator</span>:
- <span style="color:#ff79c6">literals</span>:
  - db-password=12345
  <span style="color:#ff79c6">name</span>: sl-demo-app
  <span style="color:#ff79c6">type</span>: Opaque
</code></pre></div><p>ç„¶ååŒæ ·çš„æˆ‘ä»¬å›åˆ°æ ¹ç›®å½•ä¸‹é¢æ‰§è¡Œ<code>kustomize build</code>å‘½ä»¤æ„å»ºä¸‹æ¨¡æ¿ï¼Œè¾“å‡ºå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomize build k8s/overlays/prod
apiVersion: v1
data:
  db-password: <span style="color:#8be9fd;font-style:italic">MTIzNDU</span><span style="color:#ff79c6">=</span>
kind: Secret
metadata:
  name: sl-demo-app-6ft88t2625
type: Opaque
---
apiVersion: v1
kind: Service
metadata:
  name: sl-demo-app
spec:
  ports:
  - name: http
    port: <span style="color:#bd93f9">8080</span>
  selector:
    app: sl-demo-app
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  replicas: <span style="color:#bd93f9">10</span>
  selector:
    matchLabels:
      app: sl-demo-app
  strategy:
    rollingUpdate:
      maxSurge: <span style="color:#bd93f9">1</span>
      maxUnavailable: <span style="color:#bd93f9">1</span>
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: sl-demo-app
    spec:
      containers:
      - env:
        - name: CUSTOM_ENV_VARIABLE
          value: Value defined by Kustomize â¤ï¸
        image: foo/bar:latest
        name: app
        ports:
        - containerPort: <span style="color:#bd93f9">8080</span>
          name: http
          protocol: TCP
</code></pre></div><blockquote>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° secret å¯¹è±¡çš„åç§°æ˜¯<code>sl-demo-app-6ft88t2625</code>ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬å®šä¹‰çš„<code>sl-demo-app</code>ï¼Œè¿™æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºå¦‚æœæ›´æ”¹äº† secret å†…å®¹ï¼Œå°±å¯ä»¥è§¦å‘æ»šåŠ¨æ›´æ–°äº†ã€‚</p>
</blockquote>
<p>åŒæ ·çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨ Deployment ä¸­ä½¿ç”¨è¿™ä¸ª Secret å¯¹è±¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥åƒä¹‹å‰ä¸€æ ·æ·»åŠ ä¸€ä¸ªä½¿ç”¨ Secret çš„æ–°çš„å±‚å®šä¹‰å³å¯ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬è¿™é‡ŒåƒæŠŠ<code>db-password</code>çš„å€¼é€šè¿‡ç¯å¢ƒå˜é‡æ³¨å…¥åˆ° Deployment ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®šä¹‰ä¸‹é¢è¿™æ ·çš„æ–°çš„å±‚ä¿¡æ¯ï¼šï¼ˆdatabase-secret.yamlï¼‰</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ff79c6">apiVersion</span>: apps/v1
<span style="color:#ff79c6">kind</span>: Deployment
<span style="color:#ff79c6">metadata</span>:
  <span style="color:#ff79c6">name</span>: sl-demo-app
<span style="color:#ff79c6">spec</span>:
  <span style="color:#ff79c6">template</span>:
    <span style="color:#ff79c6">spec</span>:
      <span style="color:#ff79c6">containers</span>:
      - <span style="color:#ff79c6">name</span>: app
        <span style="color:#ff79c6">env</span>:
        - <span style="color:#ff79c6">name</span>: <span style="color:#f1fa8c">&#34;DB_PASSWORD&#34;</span>
          <span style="color:#ff79c6">valueFrom</span>:
            <span style="color:#ff79c6">secretKeyRef</span>:
              <span style="color:#ff79c6">name</span>: sl-demo-app
              <span style="color:#ff79c6">key</span>: db.password
</code></pre></div><p>ç„¶ååŒæ ·çš„ï¼Œæˆ‘ä»¬æŠŠè¿™é‡Œå®šä¹‰çš„å±‚æ·»åŠ åˆ°<code>k8s/overlays/prod/kustomization.yaml</code>æ–‡ä»¶ä¸­å»ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ff79c6">apiVersion</span>: kustomize.config.k8s.io/v1beta1
<span style="color:#ff79c6">kind</span>: Kustomization

<span style="color:#ff79c6">bases</span>:
- ../../base

<span style="color:#ff79c6">patchesStrategicMerge</span>:
- custom-env.yaml
- replica-and-rollout-strategy.yaml
- database-secret.yaml

<span style="color:#ff79c6">secretGenerator</span>:
- <span style="color:#ff79c6">literals</span>:
  - db-password=12345
  <span style="color:#ff79c6">name</span>: sl-demo-app
  <span style="color:#ff79c6">type</span>: Opaque
</code></pre></div><p>ç°åœ¨æˆ‘ä»¬æ¥æ„å»ºæ•´ä¸ªçš„ prod ç›®å½•ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„ä¿¡æ¯ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomize build k8s/overlays/prod
apiVersion: v1
data:
  db-password: <span style="color:#8be9fd;font-style:italic">MTIzNDU</span><span style="color:#ff79c6">=</span>
kind: Secret
metadata:
  name: sl-demo-app-6ft88t2625
type: Opaque
---
apiVersion: v1
kind: Service
metadata:
  name: sl-demo-app
spec:
  ports:
  - name: http
    port: <span style="color:#bd93f9">8080</span>
  selector:
    app: sl-demo-app
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  replicas: <span style="color:#bd93f9">10</span>
  selector:
    matchLabels:
      app: sl-demo-app
  strategy:
    rollingUpdate:
      maxSurge: <span style="color:#bd93f9">1</span>
      maxUnavailable: <span style="color:#bd93f9">1</span>
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: sl-demo-app
    spec:
      containers:
      - env:
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              key: db.password
              name: sl-demo-app-6ft88t2625
        - name: CUSTOM_ENV_VARIABLE
          value: Value defined by Kustomize â¤ï¸
        image: foo/bar:latest
        name: app
        ports:
        - containerPort: <span style="color:#bd93f9">8080</span>
          name: http
          protocol: TCP
</code></pre></div><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>secretKeyRef.name</code>çš„å€¼ä¹ŸæŒ‡å®šçš„è¢«ä¿®æ”¹æˆäº†ä¸Šé¢ç”Ÿæˆçš„ secret å¯¹è±¡çš„åç§°ã€‚</p>
<blockquote>
<p>ç”±äº Secret æ˜¯ä¸€äº›ç§å¯†çš„ä¿¡æ¯ï¼Œæ‰€ä»¥æœ€å¥½æ˜¯åœ¨å®‰å…¨çš„ç¯å¢ƒä¸­æ¥æ·»åŠ ä¸Šé¢çš„ secret çš„å¯¹è±¡ï¼Œè€Œä¸åº”è¯¥å’Œå…¶ä»–ä»£ç ä¹‹ç±»çš„ä¸€èµ·è¢«æäº¤åˆ°ä»£ç ä»“åº“ä¹‹ç±»çš„å»ã€‚</p>
</blockquote>
<p>å¦‚æœæ˜¯ ConfigMap çš„è¯ä¹Ÿæ˜¯åŒæ ·çš„é€»è¾‘ï¼Œæœ€åä¼šç”Ÿæˆä¸€ä¸ª hash å€¼çš„åç§°ï¼Œè¿™æ ·åœ¨ ConfigMap æ›´æ”¹æ—¶å¯ä»¥è§¦å‘é‡æ–°éƒ¨ç½²ã€‚</p>
<h3 id="ä¿®æ”¹é•œåƒ">ä¿®æ”¹é•œåƒ</h3>
<p>å’Œ secret èµ„æºå¯¹è±¡ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»å‘½ä»¤è¡Œç›´æ¥æ›´æ”¹é•œåƒæˆ–è€… tagï¼Œå¦‚æœä½ éœ€è¦éƒ¨ç½²é€šè¿‡ CI/CD ç³»ç»Ÿæ ‡è®°çš„é•œåƒçš„è¯è¿™å°±éå¸¸æœ‰ç”¨äº†ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬è¿™é‡Œæ¥ä¿®æ”¹ä¸‹é•œåƒçš„ tagï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ <span style="color:#8be9fd;font-style:italic">cd</span> k8s/overlays/prod
$ <span style="color:#8be9fd;font-style:italic">TAG_VERSION</span><span style="color:#ff79c6">=</span>3.4.5
$ kustomize edit <span style="color:#8be9fd;font-style:italic">set</span> image foo/bar<span style="color:#ff79c6">=</span>foo/bar:<span style="color:#8be9fd;font-style:italic">$TAG_VERSION</span>
</code></pre></div><blockquote>
<p>ä¸€èˆ¬æƒ…å†µä¸‹<code>TAG_VERSION</code>å¸¸å¸¸è¢«å®šä¹‰åœ¨ CI/CD ç³»ç»Ÿä¸­ã€‚</p>
</blockquote>
<p>ç°åœ¨çš„<code>kustomization.yaml</code>æ–‡ä»¶å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ff79c6">apiVersion</span>: kustomize.config.k8s.io/v1beta1
<span style="color:#ff79c6">kind</span>: Kustomization

<span style="color:#ff79c6">bases</span>:
- ../../base

<span style="color:#ff79c6">patchesStrategicMerge</span>:
- custom-env.yaml
- replica-and-rollout-strategy.yaml
- database-secret.yaml

<span style="color:#ff79c6">secretGenerator</span>:
- <span style="color:#ff79c6">literals</span>:
  - db-password=12345
  <span style="color:#ff79c6">name</span>: sl-demo-app
  <span style="color:#ff79c6">type</span>: Opaque

<span style="color:#ff79c6">images</span>:
- <span style="color:#ff79c6">name</span>: foo/bar
  <span style="color:#ff79c6">newName</span>: foo/bar
  <span style="color:#ff79c6">newTag</span>: <span style="color:#bd93f9">3.4.5</span>
</code></pre></div><p>åŒæ ·å›åˆ°æ ¹ç›®å½•ä¸‹é¢æ„å»ºè¯¥æ¨¡æ¿ï¼Œä¼šå¾—åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„ä¿¡æ¯ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomize build k8s/overlays/prod
apiVersion: v1
data:
  db-password: <span style="color:#8be9fd;font-style:italic">MTIzNDU</span><span style="color:#ff79c6">=</span>
kind: Secret
metadata:
  name: sl-demo-app-6ft88t2625
type: Opaque
---
apiVersion: v1
kind: Service
metadata:
  name: sl-demo-app
spec:
  ports:
  - name: http
    port: <span style="color:#bd93f9">8080</span>
  selector:
    app: sl-demo-app
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  replicas: <span style="color:#bd93f9">10</span>
  selector:
    matchLabels:
      app: sl-demo-app
  strategy:
    rollingUpdate:
      maxSurge: <span style="color:#bd93f9">1</span>
      maxUnavailable: <span style="color:#bd93f9">1</span>
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: sl-demo-app
    spec:
      containers:
      - env:
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              key: db.password
              name: sl-demo-app-6ft88t2625
        - name: CUSTOM_ENV_VARIABLE
          value: Value defined by Kustomize â¤ï¸
        image: foo/bar:3.4.5
        name: app
        ports:
        - containerPort: <span style="color:#bd93f9">8080</span>
          name: http
          protocol: TCP
</code></pre></div><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° Deployment çš„ç¬¬ä¸€ä¸ª<code>container.image</code>å·²ç»è¢«ä¿®æ”¹äº† 3.4.5 ç‰ˆæœ¬äº†ã€‚</p>
<p>æœ€ç»ˆæˆ‘ä»¬å®šåˆ¶çš„æ¨¡æ¿æ–‡ä»¶ç›®å½•ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ tree .
.
â””â”€â”€ k8s
    â”œâ”€â”€ base
    â”‚Â Â  â”œâ”€â”€ deployment.yaml
    â”‚Â Â  â”œâ”€â”€ kustomization.yaml
    â”‚Â Â  â””â”€â”€ service.yaml
    â””â”€â”€ overlays
        â””â”€â”€ prod
            â”œâ”€â”€ custom-env.yaml
            â”œâ”€â”€ database-secret.yaml
            â”œâ”€â”€ kustomization.yaml
            â””â”€â”€ replica-and-rollout-strategy.yaml

<span style="color:#bd93f9">4</span> directories, <span style="color:#bd93f9">7</span> files
</code></pre></div><p>è¦å®‰è£…åˆ°é›†ç¾¤ä¸­ä¹Ÿå¾ˆç®€å•ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomize build k8s/overlays/prod | kubectl apply -f -
</code></pre></div><h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ°äº†å¦‚ä½•ä½¿ç”¨ Kustomize çš„å¼ºå¤§åŠŸèƒ½æ¥å®šä¹‰ä½ çš„ Kuberentes èµ„æºæ¸…å•æ–‡ä»¶ï¼Œè€Œä¸éœ€è¦ä½¿ç”¨ä»€ä¹ˆé¢å¤–çš„æ¨¡æ¿ç³»ç»Ÿï¼Œåˆ›å»ºçš„æ‰€æœ‰çš„ä¿®æ”¹çš„å—æ–‡ä»¶éƒ½å°†è¢«åº”ç”¨åˆ°åŸå§‹åŸºç¡€æ¨¡æ¿æ–‡ä»¶ä¹‹ä¸Šï¼Œè€Œä¸ç”¨ä½¿ç”¨ä»€ä¹ˆèŠ±æ‹¬å·ä¹‹ç±»çš„ä¿®æ”¹æ¥æ›´æ”¹å®ƒï¼ˆè²Œä¼¼æ— å½¢ä¸­æœ‰é„™è§†äº†ä¸‹ Helm ğŸ˜„ï¼‰ã€‚</p>
<p>Kustomize ä¸­è¿˜æœ‰å¾ˆå¤šå…¶ä»–é«˜çº§ç”¨æ³•ï¼Œæ¯”å¦‚ mixins å’Œç»§æ‰¿æˆ–è€…å…è®¸ä¸ºæ¯ä¸€ä¸ªåˆ›å»ºçš„å¯¹è±¡å®šä¹‰ä¸€ä¸ªåç§°ã€æ ‡ç­¾æˆ–è€… namespace ç­‰ç­‰ï¼Œä½ å¯ä»¥åœ¨å®˜æ–¹çš„ <a href="https://github.com/kubernetes-sigs/kustomize">Kustomize GitHub ä»£ç ä»“åº“</a>ä¸­æŸ¥çœ‹é«˜çº§ç¤ºä¾‹å’Œæ–‡æ¡£ã€‚</p>
<!-- raw HTML omitted -->
<h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2>
<ul>
<li><a href="https://github.com/kubernetes-sigs/kustomize">Kustomize GitHub</a></li>
<li><a href="https://blog.stack-labs.com/code/kustomize-101/">Kustomize - The right way to do templating in Kubernetes</a></li>
<li><a href="https://www.exoscale.com/syslog/kubernetes-kustomize/">Configuring Kubernetes Applications with kustomize</a></li>
</ul>

                
                
<div class="entry-shang text-center">
    
	    <p> ã€Œå¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨,è¯·éšæ„æ‰“èµã€</p>
	
	<button class="zs show-zs btn btn-bred">èµèµæ”¯æŒ</button>
</div>
<div class="zs-modal-bg"></div>
<div class="zs-modal-box">
	<div class="zs-modal-head">
		<button type="button" class="close">Ã—</button>
		<span class="author"><a href="https://qnxr.xyz"><img src="/img/favicon.png" />é’å¹´å¤æ—¥IT</a></span>
        
	        <p class="tip"><i></i><span>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨,è¯·éšæ„æ‰“èµ</span></p>
		
 
	</div>
	<div class="zs-modal-body">
		<div class="zs-modal-btns">
			<button class="btn btn-blink" data-num="2">2å…ƒ</button>
			<button class="btn btn-blink" data-num="5">5å…ƒ</button>
			<button class="btn btn-blink" data-num="10">10å…ƒ</button>
			<button class="btn btn-blink" data-num="50">50å…ƒ</button>
			<button class="btn btn-blink" data-num="100">100å…ƒ</button>
			<button class="btn btn-blink" data-num="1">ä»»æ„é‡‘é¢</button>
		</div>
		<div class="zs-modal-pay">
			<button class="btn btn-bred" id="pay-text">2å…ƒ</button>
			<p>ä½¿ç”¨<span id="pay-type">å¾®ä¿¡</span>æ‰«æäºŒç»´ç å®Œæˆæ”¯ä»˜</p>
			<img src="/img/reward/wechat-2.png"  id="pay-image"/>
		</div>
	</div>
	<div class="zs-modal-footer">
		<label><input type="radio" name="zs-type" value="wechat" class="zs-type" checked="checked"><span ><span class="zs-wechat"><img src="/img/reward/wechat-btn.png"/></span></label>
		<label><input type="radio" name="zs-type" value="alipay" class="zs-type" class="zs-alipay"><img src="/img/reward/alipay-btn.png"/></span></label>
	</div>
</div>
<script type="text/javascript" src="/js/reward.js"></script>

                

                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/post/install-kubesphere-on-k8s/" data-toggle="tooltip" data-placement="top" title="åœ¨ç°æœ‰ Kubernetes é›†ç¾¤ä¸Šå®‰è£… KubeSphere">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/post/use-github-actions-build-go-app/" data-toggle="tooltip" data-placement="top" title="ä½¿ç”¨ GitHub Actions è‡ªåŠ¨åŒ–æ„å»º Golang åº”ç”¨">Next
                            Post &rarr;</a>
                    </li>
                    
                </ul>

                
<div id="disqus-comment"></div>



            </div>
            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">æ ‡ç­¾</a></h5>
                    <div class="tags">
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/affinity" title="affinity">
                            affinity
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/alertmanager" title="alertmanager">
                            alertmanager
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/argo" title="argo">
                            argo
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/cd" title="cd">
                            cd
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/ci" title="ci">
                            ci
                        </a>
                        
                        
                        
                        <a href="/tags/ci/cd" title="ci/cd">
                            ci/cd
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/configmap" title="configmap">
                            configmap
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/coredns" title="coredns">
                            coredns
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/dashboard" title="dashboard">
                            dashboard
                        </a>
                        
                        
                        
                        <a href="/tags/deployment" title="deployment">
                            deployment
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/devops" title="devops">
                            devops
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/django" title="django">
                            django
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/docker" title="docker">
                            docker
                        </a>
                        
                        
                        
                        <a href="/tags/dockerfile" title="dockerfile">
                            dockerfile
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/drone" title="drone">
                            drone
                        </a>
                        
                        
                        
                        <a href="/tags/efk" title="efk">
                            efk
                        </a>
                        
                        
                        
                        <a href="/tags/elastic" title="elastic">
                            elastic
                        </a>
                        
                        
                        
                        <a href="/tags/elasticsearch" title="elasticsearch">
                            elasticsearch
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/envoy" title="envoy">
                            envoy
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/flask" title="flask">
                            flask
                        </a>
                        
                        
                        
                        <a href="/tags/fluentd" title="fluentd">
                            fluentd
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/github" title="github">
                            github
                        </a>
                        
                        
                        
                        <a href="/tags/gitlab" title="gitlab">
                            gitlab
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/gitops" title="gitops">
                            gitops
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/goland" title="goland">
                            goland
                        </a>
                        
                        
                        
                        <a href="/tags/golang" title="golang">
                            golang
                        </a>
                        
                        
                        
                        <a href="/tags/grafana" title="grafana">
                            grafana
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/haproxy" title="haproxy">
                            haproxy
                        </a>
                        
                        
                        
                        <a href="/tags/harbor" title="harbor">
                            harbor
                        </a>
                        
                        
                        
                        <a href="/tags/helm" title="helm">
                            helm
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/https" title="https">
                            https
                        </a>
                        
                        
                        
                        <a href="/tags/hugo" title="hugo">
                            hugo
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/ingress" title="ingress">
                            ingress
                        </a>
                        
                        
                        
                        <a href="/tags/ingress-nginx" title="ingress-nginx">
                            ingress-nginx
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/iptables" title="iptables">
                            iptables
                        </a>
                        
                        
                        
                        <a href="/tags/ipvs" title="ipvs">
                            ipvs
                        </a>
                        
                        
                        
                        <a href="/tags/istio" title="istio">
                            istio
                        </a>
                        
                        
                        
                        <a href="/tags/java" title="java">
                            java
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/jenkins" title="jenkins">
                            jenkins
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/k8s" title="k8s">
                            k8s
                        </a>
                        
                        
                        
                        <a href="/tags/k8s%E6%8A%80%E6%9C%AF%E5%9C%88" title="k8sæŠ€æœ¯åœˆ">
                            k8sæŠ€æœ¯åœˆ
                        </a>
                        
                        
                        
                        <a href="/tags/kafka" title="kafka">
                            kafka
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/kibana" title="kibana">
                            kibana
                        </a>
                        
                        
                        
                        <a href="/tags/kind" title="kind">
                            kind
                        </a>
                        
                        
                        
                        <a href="/tags/kong" title="kong">
                            kong
                        </a>
                        
                        
                        
                        <a href="/tags/kubeadm" title="kubeadm">
                            kubeadm
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/kubelet" title="kubelet">
                            kubelet
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/kubernetes" title="kubernetes">
                            kubernetes
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/kustomize" title="kustomize">
                            kustomize
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/loki" title="loki">
                            loki
                        </a>
                        
                        
                        
                        <a href="/tags/mac" title="mac">
                            mac
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/microservice" title="microservice">
                            microservice
                        </a>
                        
                        
                        
                        <a href="/tags/monitor" title="monitor">
                            monitor
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/netfilter" title="netfilter">
                            netfilter
                        </a>
                        
                        
                        
                        <a href="/tags/nfs" title="nfs">
                            nfs
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/nginx" title="nginx">
                            nginx
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/operator" title="operator">
                            operator
                        </a>
                        
                        
                        
                        <a href="/tags/ops" title="ops">
                            ops
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/pipeline" title="pipeline">
                            pipeline
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/pod" title="pod">
                            pod
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/prometheus" title="prometheus">
                            prometheus
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/pv" title="pv">
                            pv
                        </a>
                        
                        
                        
                        <a href="/tags/pvc" title="pvc">
                            pvc
                        </a>
                        
                        
                        
                        <a href="/tags/pycharm" title="pycharm">
                            pycharm
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/python" title="python">
                            python
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/rbac" title="rbac">
                            rbac
                        </a>
                        
                        
                        
                        <a href="/tags/react" title="react">
                            react
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/scheduler" title="scheduler">
                            scheduler
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/security" title="security">
                            security
                        </a>
                        
                        
                        
                        <a href="/tags/service" title="service">
                            service
                        </a>
                        
                        
                        
                        <a href="/tags/service-api" title="service-api">
                            service-api
                        </a>
                        
                        
                        
                        <a href="/tags/service-mesh" title="service-mesh">
                            service-mesh
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/slave" title="slave">
                            slave
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/storageclass" title="storageclass">
                            storageclass
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/tcpdump" title="tcpdump">
                            tcpdump
                        </a>
                        
                        
                        
                        <a href="/tags/tdd" title="tdd">
                            tdd
                        </a>
                        
                        
                        
                        <a href="/tags/tekton" title="tekton">
                            tekton
                        </a>
                        
                        
                        
                        <a href="/tags/tips" title="tips">
                            tips
                        </a>
                        
                        
                        
                        <a href="/tags/traefik" title="traefik">
                            traefik
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/vault" title="vault">
                            vault
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/vscode" title="vscode">
                            vscode
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/webpack" title="webpack">
                            webpack
                        </a>
                        
                        
                        
                        <a href="/tags/websocket" title="websocket">
                            websocket
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/wsl" title="wsl">
                            wsl
                        </a>
                        
                        
                        
                        <a href="/tags/yaml" title="yaml">
                            yaml
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1" title="å¾®æœåŠ¡">
                            å¾®æœåŠ¡
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/%E7%9F%A5%E8%AF%86%E6%98%9F%E7%90%83" title="çŸ¥è¯†æ˜Ÿçƒ">
                            çŸ¥è¯†æ˜Ÿçƒ
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/%E8%AF%BE%E7%A8%8B" title="è¯¾ç¨‹">
                            è¯¾ç¨‹
                        </a>
                        
                        
                        
                        <a href="/tags/%E8%B0%83%E5%BA%A6" title="è°ƒåº¦">
                            è°ƒåº¦
                        </a>
                        
                        
                        
                        <a href="/tags/%E9%98%BF%E9%87%8C%E4%BA%91" title="é˜¿é‡Œäº‘">
                            é˜¿é‡Œäº‘
                        </a>
                        
                        
                        
                        
                        
                        
                    </div>
                </section>
                

                
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                    
                    <li>
                        <a href="mailto:1290851757@qq.com">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    

                    
                    <li>
                        <a href="img/wechat_qrcode.jpg">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    

                    
                    <li>
                        <a target="_blank" href="img/wechat_qrcode.jpg">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    

		    
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/xiaobingchan">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    <li>
                        <a target="_blank" href="img/alipay.jpg">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    
                    
            
            
            
                </ul>
		<p class="copyright text-muted">
                    Copyright &copy; é’å¹´å¤æ—¥IT 2021
                    <br>
                    <a href="https://themes.gohugo.io/hugo-theme-cleanwhite"></a><a href="http://qnxr.xyz">é’å¹´å¤æ—¥ITç‰ˆæƒæ‰€æœ‰</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=xiaobingchan&repo=xiaobingchan.github.io&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    async("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>






<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-150373352-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</body>
</html>
